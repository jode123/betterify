(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{2634:function(e,t,a){Promise.resolve().then(a.bind(a,1924))},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},1924:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(7437),l=a(2265),r=a(9376);let n=e=>{let{onTap:t,children:a,className:r=""}=e,n=(0,l.useRef)(0),i=(0,l.useRef)({x:0,y:0}),[o,c]=(0,l.useState)(!1);return(0,s.jsx)("div",{className:"".concat(r," ").concat(o?"touching":""),onTouchStart:e=>{n.current=Date.now(),i.current={x:e.touches[0].clientX,y:e.touches[0].clientY},c(!0)},onTouchEnd:e=>{let a={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},s=Date.now()-n.current,l=Math.hypot(a.x-i.current.x,a.y-i.current.y);s<300&&l<20&&t(),c(!1)},children:a})},i=()=>(0,s.jsx)("div",{className:"musish-container flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-[var(--text-primary)] text-xl animate-pulse",children:"Loading your personalized experience..."})}),o=e=>{let{src:t,alt:a,className:r,isArtist:n}=e,[i,o]=(0,l.useState)(t),[c,u]=(0,l.useState)(!0),[d,m]=(0,l.useState)(!1),v=n?"/default-artist.png":"/default-album.png";return(0,l.useEffect)(()=>{o(t),u(!0),m(!1)},[t]),(0,s.jsxs)("div",{className:"relative ".concat(r),children:[c&&(0,s.jsx)("div",{className:"absolute inset-0 bg-[var(--background-secondary)] animate-pulse rounded-lg"}),(0,s.jsx)("img",{src:i,alt:a,className:"w-full h-full object-cover rounded-lg transition-opacity duration-300 ".concat(c?"opacity-0":"opacity-100"),onLoad:()=>{u(!1),m(!1)},onError:()=>{console.log("Image failed to load:",t),o(v),u(!1),m(!0)},loading:"lazy"})]})},c=async()=>{let e="e540e79e4d0cd99309768db3e9d26789";try{var t,a,s,l,r,n,i,o,c;if(!e)throw console.error("API Key missing at runtime"),Error("Last.fm API key is missing");let u=async(t,a)=>{let s=new URLSearchParams({method:t,api_key:e,format:"json",limit:"15"});a&&s.append("tag",a);let l=await fetch("".concat("https://ws.audioscrobbler.com/2.0","/?").concat(s));return l.ok?l.json():(console.error("".concat(t," request failed:"),{status:l.status,statusText:l.statusText,url:l.url.replace(e,"REDACTED")}),null)},[d,m,v,h]=await Promise.all([u("chart.gettopartists"),u("tag.gettopalbums","indie"),u("chart.gettoptracks"),u("tag.gettopalbums","featured")]),x=(null==d?void 0:null===(s=d.artists)||void 0===s?void 0:null===(a=s.artist)||void 0===a?void 0:null===(t=a.filter(e=>{var t;return(null==e?void 0:e.name)&&(null==e?void 0:null===(t=e.image)||void 0===t?void 0:t.length)>0}))||void 0===t?void 0:t.map(e=>{var t;let a=(null===(t=e.image.reverse().find(e=>(null==e?void 0:e["#text"])&&e["#text"].startsWith("http")))||void 0===t?void 0:t["#text"])||"/default-artist.png";return{name:e.name,image:a,listeners:e.listeners||"0"}}))||[],f=(null==m?void 0:null===(n=m.albums)||void 0===n?void 0:null===(r=n.album)||void 0===r?void 0:null===(l=r.filter(e=>{var t,a;return(null==e?void 0:e.name)&&(null==e?void 0:null===(t=e.artist)||void 0===t?void 0:t.name)&&(null==e?void 0:null===(a=e.image)||void 0===a?void 0:a.length)>0}))||void 0===l?void 0:l.map(e=>{var t;return{name:e.name,artist:e.artist.name,image:(null===(t=e.image.reverse().find(e=>(null==e?void 0:e["#text"])&&e["#text"].startsWith("http")))||void 0===t?void 0:t["#text"])||"/default-album.png"}}))||[],g=(null==h?void 0:null===(c=h.albums)||void 0===c?void 0:null===(o=c.album)||void 0===o?void 0:null===(i=o.filter(e=>{var t,a;return(null==e?void 0:e.name)&&(null==e?void 0:null===(t=e.artist)||void 0===t?void 0:t.name)&&(null==e?void 0:null===(a=e.image)||void 0===a?void 0:a.length)>0}))||void 0===i?void 0:i.map(e=>{var t;let a=(null===(t=e.image.reverse().find(e=>(null==e?void 0:e["#text"])&&e["#text"].startsWith("http")))||void 0===t?void 0:t["#text"])||"/default-album.png";return{name:e.name,artist:e.artist.name,image:a,playcount:e.playcount||"0"}}))||[];return{artists:x,albums:f,tracks:[],featuredAlbums:g}}catch(e){return console.error("Last.fm API Error:",e),{artists:[],albums:[],tracks:[],featuredAlbums:[]}}},u=e=>{let{artist:t,onClick:a}=e;return(0,s.jsxs)(n,{onTap:()=>a(t),className:"card-container",children:[(0,s.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden bg-[var(--background-secondary)]",children:(0,s.jsx)(o,{src:t.image,alt:t.name,className:"w-full h-full object-cover",isArtist:!0})}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("h3",{className:"musish-card-title",children:t.name}),(0,s.jsxs)("p",{className:"musish-card-subtitle",children:[parseInt(t.listeners).toLocaleString()," listeners"]})]})]})},d=e=>{let{album:t,onClick:a}=e;return(0,s.jsxs)(n,{onTap:()=>a(t),className:"card-container",children:[(0,s.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden bg-[var(--background-secondary)]",children:(0,s.jsx)(o,{src:t.image,alt:t.name,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("h3",{className:"musish-card-title",children:t.name}),(0,s.jsx)("p",{className:"musish-card-subtitle",children:t.artist})]})]})};function m(){let[e,t]=(0,l.useState)([]),[a,n]=(0,l.useState)([]),[o,m]=(0,l.useState)([]),[v,h]=(0,l.useState)([]),[x,f]=(0,l.useState)(!0);(0,l.useRef)(null),(0,l.useRef)(null),(0,l.useCallback)((e,t)=>{e.current&&e.current.scrollBy({left:"left"===t?-600:600,behavior:"smooth"})},[]);let[g,p]=(0,l.useState)(0),[b,j]=(0,l.useState)(0),[y,N]=(0,l.useState)({artistsLength:0,albumsLength:0});(0,l.useEffect)(()=>{(async()=>{f(!0),console.log("API Key present:",!0);try{let e=await c();console.log("Fetched data:",e),e.artists&&e.featuredAlbums&&(t(e.artists),h(e.featuredAlbums),N({artistsLength:e.artists.length,albumsLength:e.featuredAlbums.length}))}catch(e){console.error("Error:",e)}finally{f(!1)}})()},[]);let k=(0,r.useRouter)(),w=(0,l.useCallback)(e=>{k.push("/artist/".concat(encodeURIComponent(e.name)))},[k]),S=(0,l.useCallback)(e=>{let t="".concat(e.artist," - ").concat(e.name);k.push("/album/".concat(encodeURIComponent(t)))},[k]);return(0,s.jsx)("div",{className:"min-h-screen bg-[var(--background-primary)]",children:x?(0,s.jsx)(i,{}):(0,s.jsxs)("div",{className:"px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-4xl font-bold text-[var(--text-primary)] mb-6 md:mb-8",children:"Discover"}),(0,s.jsxs)("section",{className:"mb-6 md:mb-8",children:[(0,s.jsx)("h2",{className:"text-xl md:text-2xl font-bold text-[var(--text-primary)] mb-4",children:"Top Artists"}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"overflow-x-auto scrollbar-hide -mx-4 px-4",style:{WebkitOverflowScrolling:"touch",scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,s.jsx)("div",{className:"flex gap-3 md:gap-4",children:e.map((e,t)=>(0,s.jsx)(u,{artist:e,onClick:w},t))})})})]}),(0,s.jsxs)("section",{className:"mb-6 md:mb-8",children:[(0,s.jsx)("h2",{className:"text-xl md:text-2xl font-bold text-[var(--text-primary)] mb-4",children:"Featured Albums"}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"overflow-x-auto scrollbar-hide -mx-4 px-4",style:{WebkitOverflowScrolling:"touch",scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,s.jsx)("div",{className:"flex gap-3 md:gap-4",children:v.map((e,t)=>(0,s.jsx)(d,{album:e,onClick:S},t))})})})]})]})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2634)}),_N_E=e.O()}]);