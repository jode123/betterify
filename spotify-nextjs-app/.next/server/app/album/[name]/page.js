(()=>{var e={};e.id=403,e.ids=[403],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},58523:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>c}),r(94273),r(19136),r(35866);var a=r(23191),s=r(88716),i=r(37922),l=r.n(i),n=r(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let c=["",{children:["album",{children:["[name]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,94273)),"/workspaces/betterify/spotify-nextjs-app/src/app/album/[name]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,19136)),"/workspaces/betterify/spotify-nextjs-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/workspaces/betterify/spotify-nextjs-app/src/app/album/[name]/page.tsx"],p="/album/[name]/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/album/[name]/page",pathname:"/album/[name]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},93514:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},77503:(e,t,r)=>{Promise.resolve().then(r.bind(r,62567))},87676:(e,t,r)=>{Promise.resolve().then(r.bind(r,66054))},66054:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(10326),s=r(17577),i=r(35047),l=r(67437);let n=["https://piped.video","https://piped.kavin.rocks","https://piped.syncpundit.io","https://piped.mha.fi"],o=["https://pipedapi.kavin.rocks","https://pipedapi.syncpundit.io","https://pipedapi.mha.fi","https://pipedapi.tokhmi.xyz"].map(e=>`${e}/api/v1`);async function c(e){try{let t=new AbortController,r=setTimeout(()=>t.abort(),5e3),a=await fetch(e,{method:"HEAD",signal:t.signal});return clearTimeout(r),a.ok}catch{return!1}}async function d(e){try{let t=e.replace(/[^\w\s-]/g,"").replace(/\s+/g," ").trim(),r=`${t} audio`;console.log("Searching for:",r);let a=await fetch(`/api/piped?q=${encodeURIComponent(r)}&filter=music`);if(!a.ok)throw console.error("API Response not OK:",a.status),Error("Failed to fetch from Piped API");let s=await a.json();if(console.log("Raw search results:",s),!s.items?.length)return console.log("No results found for query:",r),null;let i=s.items.slice(0,5).find(e=>{let r=e.title.toLowerCase();return t.toLowerCase().split(" ").every(e=>r.includes(e))})||s.items[0],l=i.url.split("watch?v=")[1];return console.log("Selected match:",i.title),{title:i.title,url:`https://piped.video/watch?v=${l}`,id:l,duration:i.duration,uploaded:i.uploaded,uploaderName:i.uploaderName,uploaderUrl:i.uploaderUrl,thumbnail:i.thumbnail}}catch(e){return console.error("Piped search error:",e),null}}function p({trackName:e,artist:t,onError:r}){let i=(0,s.useRef)(null),[l,n]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[d,p]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),h=async()=>{if(i.current&&o)try{l?i.current.pause():await i.current.play(),n(!l)}catch(e){console.error("Playback error:",e),r?.()}};return(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:h,disabled:d||!o,className:`p-2 rounded-full ${d?"bg-gray-500":"bg-[var(--accent-color)]"} text-white hover:scale-105 transition-transform disabled:opacity-50`,children:d?(0,a.jsxs)("svg",{className:"w-6 h-6 animate-spin",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):l?a.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}):a.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"text-[var(--text-primary)] font-medium",children:e}),a.jsx("div",{className:"text-[var(--text-secondary)] text-sm",children:t})]}),a.jsx("audio",{ref:i,src:o||void 0,onEnded:()=>n(!1),onError:r})]})}function u({params:e}){let[t,r]=(0,s.useState)(null),[n,o]=(0,s.useState)(!0),[c,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!1),[x,f]=(0,s.useState)(null),[v,g]=(0,s.useState)(!1);(0,i.useRouter)();let y=async(e,r)=>{if(!t)return;h(!0);let a=`${e.artist} ${e.name} ${t.name}`;try{let t=await d(a);t?.id?(u(r),f(t.id),g(!0),console.log("Playing track:",{track:e.name,videoTitle:t.title})):console.error("No valid video ID found for:",a)}catch(e){console.error("Error playing track:",e)}finally{h(!1)}};return n?a.jsx("div",{children:"Loading..."}):t?(0,a.jsxs)("div",{className:"min-h-screen bg-[var(--background-primary)] p-4 md:p-8 pb-24",children:[(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-6 mb-8",children:[a.jsx("div",{className:"w-full md:w-64 shrink-0",children:a.jsx(l.J,{src:t.image,alt:t.name,className:"w-full aspect-square rounded-lg shadow-xl"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl md:text-4xl font-bold text-[var(--text-primary)] mb-2",children:t.name}),a.jsx("p",{className:"text-lg text-[var(--text-secondary)] mb-4",children:t.artist}),(0,a.jsxs)("p",{className:"text-sm text-[var(--text-secondary)]",children:[t.tracks.length," songs"]})]})]}),a.jsx("div",{className:"space-y-2",children:t.tracks.map((e,r)=>(0,a.jsxs)("div",{className:`track-container cursor-pointer hover:bg-[var(--background-tertiary)] ${c===r?"bg-[var(--background-tertiary)]":""}`,onClick:()=>y(e,r),children:[a.jsx("span",{className:"track-number",children:m&&c===r?"...":(r+1).toString().padStart(2,"0")}),a.jsx("div",{className:"track-art",children:a.jsx(l.J,{src:t.image,alt:t.name,className:"w-full h-full object-cover",priority:r<5})}),(0,a.jsxs)("div",{className:"track-info",children:[a.jsx("div",{className:"track-title",children:e.name}),e.artist!==t.artist&&a.jsx("div",{className:"track-artist",children:e.artist})]}),a.jsx("span",{className:"track-duration",children:"0"===e.duration?"--:--":`${Math.floor(parseInt(e.duration)/60)}:${(parseInt(e.duration)%60).toString().padStart(2,"0")}`})]},r))})]}),a.jsx(p,{videoId:x,isPlaying:v,onEnded:()=>{null!==c&&c<t.tracks.length-1?y(t.tracks[c+1],c+1):(u(null),f(null),g(!1))},onError:()=>{console.error("Playback error"),g(!1)},trackName:null!==c?t.tracks[c].name:"",artist:null!==c?t.tracks[c].artist:""})]}):a.jsx("div",{children:"Album not found"})}o[0],(async function(){for(let e of o)if(await c(e))break;for(let e of n)if(await c(e))break})().catch(console.error)},62567:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>i});var a=r(10326),s=r(77109);function i({children:e}){return a.jsx(s.SessionProvider,{children:e})}},67437:(e,t,r)=>{"use strict";r.d(t,{J:()=>l});var a=r(10326),s=r(17577),i=r(46226);let l=({src:e,alt:t,className:r="",isArtist:l=!1,priority:n=!1})=>{let[o,c]=(0,s.useState)(e),[d,p]=(0,s.useState)(!0),u=l?"/default-artist.png":"/default-album.png";return(0,s.useEffect)(()=>{c(e),p(!0)},[e]),(0,a.jsxs)("div",{className:`relative ${r}`,children:[a.jsx(i.default,{src:o,alt:t,width:500,height:500,priority:n,className:`w-full h-full object-cover transition-opacity duration-300 ${d?"opacity-0":"opacity-100"}`,onLoad:()=>p(!1),onError:()=>{c(u),p(!1)}}),d&&a.jsx("div",{className:"absolute inset-0 bg-[var(--background-secondary)] animate-pulse rounded-lg"})]})}},94273:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`/workspaces/betterify/spotify-nextjs-app/src/app/album/[name]/page.tsx#default`)},19136:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>n});var a=r(19510),s=r(45317),i=r.n(s);r(5023);let l=(0,r(68570).createProxy)(String.raw`/workspaces/betterify/spotify-nextjs-app/src/components/AuthProvider.tsx#AuthProvider`),n={title:"Spotify Web App",description:"Apple Music inspired Spotify web app"};function o({children:e}){return(0,a.jsxs)("html",{lang:"en",children:[a.jsx("head",{children:a.jsx("link",{href:"https://fonts.googleapis.com/icon?family=Material+Icons",rel:"stylesheet"})}),a.jsx("body",{className:i().className,children:a.jsx(l,{children:e})})]})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,672,224],()=>r(58523));module.exports=a})();